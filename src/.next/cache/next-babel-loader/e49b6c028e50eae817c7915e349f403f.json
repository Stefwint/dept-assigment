{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport axios from 'axios';\nimport { parseCookies } from 'nookies';\nimport config from '../theme.config';\n\nvar getPreview = function getPreview(ctx) {\n  var data, errorCode, cookies, backCookie, query, id, wpnonce, previewData;\n  return _regeneratorRuntime.async(function getPreview$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          data = false;\n          errorCode = false;\n          cookies = parseCookies(ctx);\n          _context.prev = 3;\n          backCookie = Object.keys(cookies).map(function (key) {\n            return \"\".concat(key, \"=\").concat(cookies[key]);\n          }).join('; ');\n          query = ctx.query;\n          id = query.id, wpnonce = query.wpnonce;\n          _context.next = 9;\n          return _regeneratorRuntime.awrap(axios.get(\"\".concat(config.wordpress.routes.preview, \"?id=\").concat(id, \"&_wpnonce=\").concat(wpnonce), {\n            headers: {\n              Cookie: backCookie\n            }\n          }));\n\n        case 9:\n          previewData = _context.sent;\n          data = previewData ? previewData.data : false;\n          _context.next = 16;\n          break;\n\n        case 13:\n          _context.prev = 13;\n          _context.t0 = _context[\"catch\"](3);\n          errorCode = _context.t0.message;\n\n        case 16:\n          console.log(data, errorCode);\n          return _context.abrupt(\"return\", {\n            data: data,\n            errorCode: errorCode\n          });\n\n        case 18:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, [[3, 13]]);\n};\n\nexport default getPreview;","map":{"version":3,"sources":["/Users/stefwinterswijk/Werk/dept/src/utils/getPreview.js"],"names":["axios","parseCookies","config","getPreview","ctx","data","errorCode","cookies","backCookie","Object","keys","map","key","join","query","id","wpnonce","get","wordpress","routes","preview","headers","Cookie","previewData","message","console","log"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,YAAT,QAA6B,SAA7B;AACA,OAAOC,MAAP,MAAmB,iBAAnB;;AAEA,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAAOC,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACbC,UAAAA,IADa,GACN,KADM;AAEbC,UAAAA,SAFa,GAED,KAFC;AAGXC,UAAAA,OAHW,GAGDN,YAAY,CAACG,GAAD,CAHX;AAAA;AAKTI,UAAAA,UALS,GAKIC,MAAM,CAACC,IAAP,CAAYH,OAAZ,EAChBI,GADgB,CACZ,UAACC,GAAD;AAAA,6BAAYA,GAAZ,cAAmBL,OAAO,CAACK,GAAD,CAA1B;AAAA,WADY,EAEhBC,IAFgB,CAEX,IAFW,CALJ;AAQPC,UAAAA,KARO,GAQGV,GARH,CAQPU,KARO;AASPC,UAAAA,EATO,GASSD,KATT,CASPC,EATO,EASHC,OATG,GASSF,KATT,CASHE,OATG;AAAA;AAAA,2CAUWhB,KAAK,CAACiB,GAAN,WACrBf,MAAM,CAACgB,SAAP,CAAiBC,MAAjB,CAAwBC,OADH,iBACiBL,EADjB,uBACgCC,OADhC,GAExB;AACEK,YAAAA,OAAO,EAAE;AACPC,cAAAA,MAAM,EAAEd;AADD;AADX,WAFwB,CAVX;;AAAA;AAUTe,UAAAA,WAVS;AAkBflB,UAAAA,IAAI,GAAGkB,WAAW,GAAGA,WAAW,CAAClB,IAAf,GAAsB,KAAxC;AAlBe;AAAA;;AAAA;AAAA;AAAA;AAoBfC,UAAAA,SAAS,GAAG,YAAMkB,OAAlB;;AApBe;AAsBjBC,UAAAA,OAAO,CAACC,GAAR,CAAYrB,IAAZ,EAAkBC,SAAlB;AAtBiB,2CAuBV;AAAED,YAAAA,IAAI,EAAJA,IAAF;AAAQC,YAAAA,SAAS,EAATA;AAAR,WAvBU;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAnB;;AA0BA,eAAeH,UAAf","sourcesContent":["import axios from 'axios';\nimport { parseCookies } from 'nookies';\nimport config from '../theme.config';\n\nconst getPreview = async (ctx) => {\n  let data = false;\n  let errorCode = false;\n  const cookies = parseCookies(ctx);\n  try {\n    const backCookie = Object.keys(cookies)\n      .map((key) => `${key}=${cookies[key]}`)\n      .join('; ');\n    const { query } = ctx;\n    const { id, wpnonce } = query;\n    const previewData = await axios.get(\n      `${config.wordpress.routes.preview}?id=${id}&_wpnonce=${wpnonce}`,\n      {\n        headers: {\n          Cookie: backCookie,\n        },\n      }\n    );\n    data = previewData ? previewData.data : false;\n  } catch (error) {\n    errorCode = error.message;\n  }\n  console.log(data, errorCode);\n  return { data, errorCode };\n};\n\nexport default getPreview;\n"]},"metadata":{},"sourceType":"module"}